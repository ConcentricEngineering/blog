= Node.js Communication with Amazon S3


.Server code
[source, javascript]
--
  var express = require('express');
  var app = express();

  app.get ('/hello', function(req, res) {
    res.end('I am alive. Thank you for your concern.\n')
  });

  app.get("/file/:file_name", function(req, res) {
    res.end("You asked for the file " + req.params.file_name + "\n");
  });

  app.get("/list", function(req, res) {
    listBucket();
    res.end("See console.log for the file list\n");
  });

app.listen(8081);
--


.Code for listBucket()
[source, javascript]
--
function listBucket() {
  var s3 = require('aws2js').load('s3', "HOHO56721", "HAHA884433");
  s3.setBucket("vschool");

  var folder = encodeURI('manuscripts/195');
  var url = '?prefix=' + folder;

  s3.get(url, 'xml', function (error, data) {
    console.log(error);
    console.log("Here comes the listing:")
    console.log(data);
    // console.log("Data count: " + data['Content'].length)
  });
}
